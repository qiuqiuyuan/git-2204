<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="../js/cookie.js"></script>
    <link rel="stylesheet" href="../css/reset.css" />
    <link rel="stylesheet" href="../css/detail.css" />
    <link
      rel="stylesheet"
      href="https://at.alicdn.com/t/font_3033706_h8elmltw4n8.css"
    />
    <link rel="stylesheet" href="../css/ui-base.css" />
    <link rel="stylesheet" href="../css/common.css" />
    <script src="../js/ajax.js"></script>
  </head>

  <body>
    <div class="header">
      <div class="w">
        <div class="location">湖北</div>

        <ul class="nav">
          <li class="loginBar"></li>
          <li>
            <a href="javascript:;">我的订单</a>
          </li>
          <li class="hover1">
            <a>我的京东&emsp;<span class="iconfont icon-xiajiantou"></span></a>
            <ul class="subNav">
              <div class="top">
                <li><a href="javascript:;">待处理订单</a></li>
                <li><a href="javascript:;">返修退换货</a></li>
                <li><a href="javascript:;">降价商品</a></li>
                <li><a href="javascript:;">我的问答</a></li>
                <li><a href="javascript:;">我的关注</a></li>
              </div>
              <div class="buttom">
                <li><a href="javascript:;">我的京豆</a></li>
                <li><a href="javascript:;">我的白条</a></li>
                <li><a href="javascript:;">我的优惠券</a></li>
                <li><a href="javascript:;">我的理财</a></li>
              </div>
            </ul>
          </li>
          <li>
            <a href="javascript:;">京东会员</a>
          </li>
          <li class="hover1">
            <a> 企业采购</a>
            <ul class="subNav">
              <li><a href="javascript:;">企业采购</a></li>
              <li><a href="javascript:;">商用场景馆</a></li>
              <li><a href="javascript:;">工业品</a></li>
              <li><a href="javascript:;">礼品卡</a></li>
            </ul>
          </li>
          <li class="hover1">
            <a> 客户服务</a>
            <ul class="subNav">
              <div class="top">
                <h5>客户</h5>
                <li><a href="javascript:;">企业采购</a></li>
                <li><a href="javascript:;">商用场景馆</a></li>
                <li><a href="javascript:;">工业品</a></li>
                <li><a href="javascript:;">礼品卡</a></li>
                <li><a href="javascript:;">企业采购</a></li>
                <li><a href="javascript:;">商用场景馆</a></li>
                <li><a href="javascript:;">工业品</a></li>
                <li><a href="javascript:;">礼品卡</a></li>
                <li><a href="javascript:;">工业品</a></li>
                <li><a href="javascript:;">礼品卡</a></li>
              </div>
              <div class="bottom">
                <h5>商户</h5>
                <li><a href="javascript:;">企业采购</a></li>
                <li><a href="javascript:;">商用场景馆</a></li>
                <li><a href="javascript:;">工业品</a></li>
                <li><a href="javascript:;">礼品卡</a></li>
                <li><a href="javascript:;">工业品</a></li>
                <li><a href="javascript:;">礼品卡</a></li>
              </div>
            </ul>
          </li>
          <li class="hover1">
            <a>网站导航</a>
          </li>
          <li class="hover1">
            <a>手机京东</a>
          </li>
          <li>
            <a>网站无障碍</a>
          </li>
        </ul>
      </div>
      <div class="searchBar">
        <div class="log">
          <a href="./index.html">
            <img
              src="https://misc.360buyimg.com/jdf/1.0.0/unit/global-header/1.0.0/i/jdlogo-201708-@1x.png"
              alt=""
          /></a>
          <li class="hover1">
            <a> 全部分类</a>
            <ul class="subNav">
              <li><a href="javascript:;">企业采购</a></li>
              <li><a href="javascript:;">商用场景馆</a></li>
              <li><a href="javascript:;">工业品</a></li>
              <li><a href="javascript:;">礼品卡</a></li>
            </ul>
          </li>
        </div>
        <div class="searchBarBox">
          <input type="text" />
          <button class="search_btn">
            <span>搜全站</span>
          </button>
          <button class="search_btn">
            <span>搜本店</span>
          </button>
        </div>
        <div class="hot_word">
          <a href="">华为</a>
          <a href="">鸿蒙</a>
          <a href="">手表</a>
          <a href="">充电器</a>
        </div>
        <!-- <div class="key_word">
            <a href="">领券中心</a>
            <a href="">国潮风尚</a>
            <a href="">今日推荐</a>
            <a href="">全球好店</a>
          </div> -->
      </div>
    </div>

    <div class="showHeader">
      <div class="showHeaderImg">
        <img src="../image/华为.png" alt="" />
      </div>
      <div class="showHeaderNav">
        <div class="subNav">
          <li>
            <a>查看所有商品&emsp;&emsp;</a>
            <ul class="subNav">
              <li>1</li>
            </ul>
          </li>
          <li>
            <a>首页</a>
            <ul class="subNav">
              <li><img src="" alt="" /></li>
            </ul>
          </li>
          <li>
            <a>P系列</a>
            <ul class="subNav">
              <li>3</li>
            </ul>
          </li>
          <li>
            <a>Mate系列</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>Nova系列</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>畅享系列</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>智慧屏</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>笔记本</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>平板</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>穿戴</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>音频配件</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>台显系列</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>路由器</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
          <li>
            <a>华为智选</a>
            <ul class="subNav">
              <li></li>
            </ul>
          </li>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="imageBar">
        <div class="left">
          <div class="left1">
            <img src="" alt="" />
            <div class="mask"></div>
          </div>
          <ul class="smImg">
            <li></li>
          </ul>
          <div class="right">
            <img src="" alt="" />
          </div>
        </div>
      </div>
      <div class="detailsR"></div>
    </div>
    <div class="footer_detail"></div>
  </body>
  <script>
    let id = "";
    id = queryString("id");

    var box = document.querySelector(".box");

    let oDetailsR = document.querySelector(".detailsR");

    let goodsName;
    let goodsImg;
    let goodsPrice;
    let smallPicList;
    let bigPicList;
    let goodsDetail;
    let countIpt;
    let oCartReduce;
    let oCartAdd;
    // console.log(id);
    setList4();
    function setList4() {
      ajax({
        type: "get",
        url: "../php/details.php",
        data: {
          id,
        },
        success: (res) => {
          let html = "";
          let html1 = "";

          const { list: list } = res;
          goodsName = list.goodsName;
          goodsImg = list.goodsImg;
          goodsPrice = list.goodsPrice;
          smallPicList = list.smallPicList;
          bigPicList = list.bigPicList;
          goodsDetail = list.goodsDetail;
          console.log(goodsDetail);
          html1 += `
         
         <div class="name">
         ${goodsName}
        </div>
        <p>
          【华为p50】骁龙888,4G全网通,原色双影像单元,万象双环设计,速来抢购；华为手机热销爆款，限量抢购，猛戳》》》
        </p>
        <div class="price">
          <span
            ><p>京东价</p>
            <p>¥</p>
            <p>${goodsPrice}</p>
            <p>降价通知</p></span
          >

          <span>促销</span>
        </div>
        <div class="address">
          <span>
            <p>配送至</p>
            <select name="" id="" class="province">
              <option value="">请选择</option>
            </select>
            <select name="" id="" class="city">
              <option value="">请选择</option>
            </select>
            <select name="" id="" class="area">
              <option value="">请选择</option>
            </select>
          </span>
        </div>

        <div class="configuration"></div>
        <div class="countBar">
          <div class="count">
            <div class="left"><input type="text" class='count_input' value="1"/></div>
            <div class="right"><button class="cartReduce">-</button><button class="cartAdd">+</button></div>
          </div>
          <button onclick="addToCart()">加入购物车</button>
        </div>
      </div>
         
         
         
         
         
         
         `;
          oDetailsR.innerHTML = html1;

          var leftBox = document.querySelector(".left");
          var leftBox1 = document.querySelector(".left1");
          var rightBox = document.querySelector(".right");
          var maskBox = document.querySelector(".mask");
          var bigImage = document.querySelector(".right img");
          var smallImage = document.querySelector(".left img");
          let smallImageSrc = smallPicList.split(",");
          let bigImageSrc = bigPicList.split(",");
          let footerDetail = document.querySelector(".footer_detail");
           countIpt = document.querySelector(".count_input");
            oCartAdd=document.querySelector('.cartAdd');
            oCartReduce=document.querySelector('.cartReduce');

          smallImage.src = bigImageSrc[0];

          oCartAdd.onclick=function(){
            let  num =countIpt.value;
              num++;
              countIpt.value=num;
          }
          oCartReduce.onclick=function(){
            let  num =countIpt.value;

            if(num<=1){
    alert("亲,不能在少了!")
    return false;
  }
              num--;
              countIpt.value=num;
          }






          let htmlDe = "";
          htmlDe = `${goodsDetail}`;

          footerDetail.innerHTML = htmlDe;

          var oUl = document.querySelector(".smImg");

          smallImage.src = bigImageSrc[0];
          bigImage.src = bigImageSrc[0];

          var res = "";
          // var res1='';
          for (var i = 0; i < smallImageSrc.length; i++) {
            res += `
       <li> <img src="${smallImageSrc[i]}" alt="" data='${bigImageSrc[i]}'></li>
       `;
          }
          oUl.innerHTML = res;
          oUl.addEventListener("mouseover", function (e) {
            if (e.target.tagName === "IMG") {
              var src = e.target.getAttribute("data");
              smallImage.src = src;
              bigImage.src = src;
            }
          });
          leftBox1.onmousemove = function (e) {
            var e = e || event;

            maskBox.style.display = "block";
            rightBox.style.display = "block";

            var scale = bigImage.clientWidth / smallImage.clientWidth;
            console.log(scale);
            var maxLeft = leftBox1.clientWidth - maskBox.clientWidth;
            var maxTop = leftBox1.clientHeight - maskBox.clientHeight;
            var x = e.pageX - leftBox1.offsetLeft - maskBox.clientWidth / 2;
            var y = e.pageY - leftBox1.offsetTop - maskBox.clientHeight / 2;
            // var x = e.x - leftBox.offsetLeft - maskBox.clientWidth / 2;
            // var y = e.y - leftBox.offsetTop - maskBox.clientHeight / 2;

            if (x < 0) x = 0;
            if (x >= maxLeft) x = maxLeft;
            if (y <= 0) y = 0;
            if (y >= maxTop) y = maxTop;

            maskBox.style.left = x + "px";
            maskBox.style.top = y + "px";

            bigImage.style.left = -(x * scale) + "px";
            bigImage.style.top = -(y * scale) + "px";
          };

          leftBox1.onmouseout = function (e) {
            maskBox.style.display = "none";
            rightBox.style.display = "none";
          };
        },
      });
    }



    function addToCart() {
      
      const user = getCookie("lgc");

      console.log(user);

      if (user) {
        ajax({
          type: "post",
          url: "../php/addToShoppingCar.php",
          data: {
            user: user,
            goodsId: id,
            buyNum: countIpt.value,
          },
          success: (res) => {
            alert(res.msg);
          },
        });
      } else {
        const url = location;
        location.href = "./log.html?locationURL" + url;
      }
    }

    const oLoginBar = document.querySelector(".loginBar");
    const user_lgc = getCookie("lgc");
    let html11 = "";
    if (user_lgc) {
      html11 = `
		<span>欢迎您,${user_lgc}&emsp;<a class='loginOut'>退出</a></span>
		`;
    } else {
      html11 = `
		
		<a href="./log.html">你好请登录</a>&emsp;<a
              href="./resg.html"
              style="color: red;"
              >免费注册</a
            >`;
    }
    oLoginBar.innerHTML = html11;
    const oLoginOut = document.querySelector(".loginOut");
    oLoginOut.onclick = function () {
      deleteCookie("lgc");
      location.href = "index.html";
    };
  </script>
</html>
